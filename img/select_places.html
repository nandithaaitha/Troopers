<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Travel Planner</title>

    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
    <link rel="stylesheet" href="select_places.css" />
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body>
    <div id="nav-placeholder"></div>
    <script>
      $(function () {
        $("#nav-placeholder").load("navbar.html");
      });
    </script>
  </head>
  <body>
    <div id="nav-placeholder"></div>

    <section class="main3">
        <div class="container">
            <h1 style="text-align: center; margin-top: 2rem">Select Places</h1>
            <div id="places-container" class="cards">
                <div class="cardRow1">
                    <!-- Cards for each place type -->
                    <div class="card" style="width: 234px; height: 321px;">
                        <img src="./img/Gas-Station.jpg" class="card-img-top" alt="Gas Station" />
                        <div class="card-body">
                            <h5 class="card-title">Gas Station</h5>
                            <p class="card-text">Find accessible gas stations.</p>
                            <button class="btn11">Show Places</button>
                        </div>
                    </div>
                    <div class="card" style="width: 234px; height: 321px;">
                        <img src="./img/hotel.jpg" class="card-img-top" alt="Hotel" />
                        <div class="card-body">
                            <h5 class="card-title">Hotels</h5>
                            <p class="card-text">Discover accessible hotels.</p>
                            <button class="btn11">Show Places</button>
                        </div>
                    </div>
                    <div class="card" style="width: 234px; height: 321px;">
                        <img src="./img/Libraries.jpg" class="card-img-top" alt="Library" />
                        <div class="card-body">
                            <h5 class="card-title">Libraries</h5>
                            <p class="card-text">Explore accessible libraries.</p>
                            <button class="btn11">Show Places</button>
                        </div>
                    </div>
                    <div class="card" style="width: 234px; height: 321px;">
                      <img src="./img/resturant.jpg" class="card-img-top" alt="Restaurant" />
                      <div class="card-body">
                          <h5 class="card-title">Restaurants</h5>
                          <p class="card-text">Discover accessible restaurants</p>
                          <button class="btn11">Show Places</button>
                      </div>
                  </div>
                    <div class="card" style="width: 234px; height: 321px;">
                        <img src="./img/DALLAS.jpg" class="card-img-top" alt="Tourist Attraction" />
                        <div class="card-body">
                            <h5 class="card-title">Tourist Attraction</h5>
                            <p class="card-text">Visit accessible tourist spots.</p>
                            <button class="btn11">Show Places</button>
                        </div>
                    </div>
                    <div class="card" style="width: 234px; height: 321px;">
                      <img src="./img/shopping.jpg" class="card-img-top" alt="Restaurant" />
                      <div class="card-body">
                          <h5 class="card-title">Shopping Malls</h5>
                          <p class="card-text">Discover accessible shopping malls</p>
                          <button class="btn11">Show Places</button>
                      </div>
                  </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modal for displaying place details -->
    <div class="modal fade" id="placeItemsModal" tabindex="-1" aria-labelledby="placeItemsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="placeItemsModalLabel">Place Details</h5>
                    <input type="text" id="searchInput" placeholder="Search by name..." class="form-control ml-3" />
                </div>
                <div class="modal-body">
                    <ul id="related-items-list" class="list-group"></ul>
                </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="contact-icon">
            <i class="fas fa-phone"></i>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.7/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
        document.querySelectorAll(".btn11").forEach((button) => {
            button.textContent = "Show Places";
            button.addEventListener("click", () => {
                const type = button.closest(".card").querySelector(".card-title").textContent.trim();
                loadCSVData(type);
            });
        });

        function loadCSVData(type) {
            const csvFilePath = getCSVPath(type);

            Papa.parse(csvFilePath, {
                download: true,
                header: true,
                
                complete: function(results) {
                    const data = results.data;
                    displayInModal(data, type);
                }
            });
        }

        function getCSVPath(type) {
            switch (type) {
                case "Gas Station":
                    return "./data/gas_stations.csv";
                case "Hotels":
                    return "./data/hotels.csv";
                case "Libraries":
                    return "./data/libraries.csv";
                case "Tourist Attraction":
                    return "./data/tourist_attractions.csv";
                case "Restaurants":
                  return "./data/restaurants.csv";
                case "Shopping Malls":
                  return "./data/shopping.csv";
                default:
                    return "";
            }
        }

        function displayInModal(data, type) {
            const modalTitle = document.getElementById("placeItemsModalLabel");
            const modalBody = document.getElementById("related-items-list");

            modalTitle.textContent = `${type} - Available Places`;
            modalBody.innerHTML = "";

            data.forEach(item => {
                const listItem = document.createElement("li");
                listItem.classList.add("list-group-item", "mb-3", "p-3", "text-center");

                listItem.innerHTML = `
                  <h5>${item["Name of Place "] || "No name provided"}</h5>
                  <p><strong>Location:</strong> ${item["Location"] || "Not available"}</p>
                  <p><strong>Accessibility:</strong> ${item["Accessbilty Feature"] || "Not available"}</p>
                  <p><strong>User Rating:</strong> ${item["User Rate"] || "Not available"}</p>
                  <p><strong>Contact:</strong> <a href="${item["Contatc Information"]}" target="_blank">${item["Contatc Information"] || "Not available"}</a></p>
                  <button class="btn btn-outline-danger add-to-wishlist" data-name="${item["Name of Place "]}">
                      <i class="fas fa-heart"></i> Add to Wishlist
                  </button>
              `;
                modalBody.appendChild(listItem);
            });

            $("#placeItemsModal").modal("show");
        }

                // Wishlist functionality
        document.addEventListener("click", function (event) {
            if (event.target.classList.contains("add-to-wishlist")) {
                const placeName = event.target.getAttribute("data-name");
                addToWishlist(placeName);
            }
        });

        function addToWishlist(placeName) {
            let wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];
            if (!wishlist.includes(placeName)) {
                wishlist.push(placeName);
                localStorage.setItem("wishlist", JSON.stringify(wishlist));
                alert(`${placeName} added to wishlist!`);
            } else {
                alert(`${placeName} is already in your wishlist!`);
            }
        }
        
        document.getElementById("searchInput").addEventListener("input", function() {
            const searchTerm = this.value.toLowerCase();
            const listItems = document.querySelectorAll("#related-items-list .list-group-item");

            listItems.forEach(item => {
                const placeName = item.querySelector("h5").textContent.toLowerCase();
                if (placeName.includes(searchTerm)) {
                    item.style.display = "";
                } else {
                    item.style.display = "none";
                }
            });
        });
    </script>
</body>
</html>
